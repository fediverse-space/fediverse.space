test-frontend:
  image: node:lts-alpine
  stage: test
  before_script:
    - cd frontend
  stage: test
  script:
    - yarn install
    - yarn lint
  cache:
    paths:
      - frontend/node_modules/
      - frontend/.yarn
  except:
    - master
  only:
    changes:
      - frontend/*
deploy-backend-develop:
  stage: deploy
  image: ilyasemenov/gitlab-ci-git-push
  only:
    refs:
      - develop
    changes:
      - backend/*
  script:
    - git-push ssh://dokku@api-develop.fediverse.space:phoenix
deploy-gephi-develop:
  stage: deploy
  image: ilyasemenov/gitlab-ci-git-push
  only:
    refs:
      - develop
    changes:
      - gephi/*
  script:
    - git-push ssh://dokku@api-develop.fediverse.space:gephi